


var adsafeVisParams = {
	mode : "jss",
	jsref : "http://online.wsj.com/static_html_files/jsframe.html?jsuri=http://ad.doubleclick.net/N2/adj/interactive.wsj.com/front_nonsub;u=null**300x250,336x280,300x600****227,220;p39=227;p39=220;;mc=b2pfreezone;tile=8;sz=300x250,336x280,300x600;ord=4040404040404040;",
	adsafeSrc : "http://fw.adsafeprotected.com/rfw/dc/16055/910908/adj/N7285.150774.B3_24_7/B7251520.90;sz=300x250;click=http://adclick.g.doubleclick.net/aclk?sa=L&ai=ByvdXa9o_UcfwAobQkwSIuoHgB_qIjKUDAAAAEAEgADgAWKqNwZ5GYMm-zobIo5AZggEXY2EtcHViLTA0NjY1ODIxMDk1NjY1MzKyAQ5vbmxpbmUud3NqLmNvbboBCWdmcF9pbWFnZcgBCdoB_wFodHRwOi8vb25saW5lLndzai5jb20vc3RhdGljX2h0bWxfZmlsZXMvanNmcmFtZS5odG1sP2pzdXJpPWh0dHA6Ly9hZC5kb3VibGVjbGljay5uZXQvTjIvYWRqL2ludGVyYWN0aXZlLndzai5jb20vZnJvbnRfbm9uc3ViO3U9bnVsbCoqMzAweDI1MCwzMzZ4MjgwLDMwMHg2MDAqKioqMjI3LDIyMDtwMzk9MjI3O3AzOT0yMjA7O21jPWIycGZyZWV6b25lO3RpbGU9ODtzej0zMDB4MjUwLDMzNngyODAsMzAweDYwMDtvcmQ9NDA0MDQwNDA0MDQwNDA0MDuYAobCAcACAuACAOoCIjIvaW50ZXJhY3RpdmUud3NqLmNvbS9mcm9udF9ub25zdWL4AvLRHpADrAKYA-ADqAMB4AQBoAYW&num=0&sig=AOD64_1cdHUE9zcXxUYVP3vw262CBrcjrQ&client=ca-pub-0466582109566532&adurl=;ord=642710798?",
	adsafeSep : "&",
	requrl : "",
	reqquery : "",
	debug : "false",
	allowEnagement : "true",
	trackMouse : "true",
	
		cocaPuffsPath : "http://static.adsafeprotected.com/detector.pix",
	
	jsFeatures : "mousetrack,cocoapuffs:100,cachebust:100",
	enagementDelay : "1-5-15",
	useAdTalk : "true",
	adTalkDtCall : "true",
	killPhrases : "",
	asid : "cf387f70-8b7f-11e2-8de2-0025903700c2",
	adWidth : "300",
	adHeight : "250"
};


(function(aG,g){var B="3.4.8";var an={list:{},codes:{GET_AD_DIMENSIONS:"a",ADTALK_GENERAL:"c",GET_SCREEN_LOC_GET_DIMENSIONS:"d",PHONE_HOME:"h",KILL_IT:"k",LOCATION_DETAILS:"l",GET_SCREEN_LOC_PIV_CALC:"p",GET_WIN_DIMENSIONS:"w",ADTALK_DUBIOUS:"D"},add:function(e){if(typeof this.list[e]!=E){this.list[e]++;}else{this.list[e]=1;}},toString:function(){var aO="";for(var e in this.list){if(this.list.hasOwnProperty(e)){aO+=e;}}return aO;},hasErrors:function(){for(var e in this.list){return true;}return false;}};var av=function(aO,aP){for(var e in aP){if(aP.hasOwnProperty(e)){aO[e]=aP[e];}}};var am="application/x-shockwave-flash";var J=function(e){return Math.round(e);};var r=(aG.debug==="true");var E="undefined";var aj=2000;var aH;var T=window!==top;var l=false;try{l=!!top.document;}catch(N){l=false;}var aq;var s=false;var y=new Date().getTime();var ar={};var H={};var f=function(e,aP){var aO=new RegExp(e+"(?=$|,)|"+e+":(?!,|$)(\\d*(?=,|$))").exec(aG.jsFeatures);if(H[e]===undefined||aP){H[e]=!!((aO&&!aO[1])||(aO&&aO[1]>Math.floor(Math.random()*100)));}return H[e];};if(r){window.featureOn=f;}var j=function(){var aS=function(){};var aR=function(aU){top.postMessage(aU,"*");};var aQ,aT,aP=false,aO="pm,inDoc,";var e=aO+"log,info,warn,dir,exception,trace,group,groupEnd,groupCollapsed,profile,profileEnd,count,clear,time,timeEnd,timeStamp,table,error,memoryProfile,memoryProfileEnd";e=e.split(",");if(typeof console!==E&&r){ar=console;for(aQ=0,len=e.length;aQ<len;aQ++){aT=e[aQ];if(typeof ar[aT]===E){if(typeof ar.log===E){ar[aT]=aS;}else{ar[aT]=ar.log;}}}ar.pm=window.postMessage?aR:aS;ar.inDoc=function(aW,aV){var aU=function(){var aX;try{if(!aP){aP=document.createElement("ul");document.body.appendChild(aP);}aX=document.createElement("li");aP.appendChild(aX);aX.textContent=aW;}catch(aY){}};if(!aV){aU();}else{setTimeout(aU,aV);}};}else{for(aQ=0,len=e.length;aQ<len;aQ++){aT=e[aQ];ar[aT]=aS;}}};j();ar.info("v"+B+", mode: "+aG.mode);ar.groupCollapsed("Server Parameters");ar.dir(aG);ar.groupEnd();var o=function(){return new Date().getTime()-y;};var aF=function(e){setTimeout(e,0);};var P=function(aP,aQ,aO,e){if(typeof aP.addEventListener!=E){if(aQ==="mouseenter"){aP.addEventListener("mouseover",ao(aO),e);}else{if(aQ==="mouseleave"){aP.addEventListener("mouseout",ao(aO),e);}else{aP.addEventListener(aQ,aO,e);}}}else{if(typeof aP.attachEvent!=E){aP.attachEvent("on"+aQ,aO);}}};var W=function(aO,aP,e){if(typeof aO.removeEventListener!=E){if(aP==="mouseenter"){aP="mouseover";e=ao;}else{if(aP==="mouseleave"){aP="mouseout";e=ao;}}aO.removeEventListner(aP,e);}else{if(typeof aO.detachEvent!=E){aO.detachEvent("on"+aP,e);}}};var ao=function(e){return function(aO){var aP=aO.relatedTarget;if(this===aP||ad(this,aP)){return;}e.call(this,aO);};};var ad=function(e,aO){if(e===aO){return false;}while(aO&&aO!==e){aO=aO.parentNode;}return aO===e;};var t=function(aO,e){var aP=""+aO;while(aP.length<e){aP="0"+aP;}return aP;};var X=function(aR,aQ){var aO="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");var aP,e=[];do{aP=aR%aQ;e.push(aO[aP]);aR=(aR-aP)/aQ;}while(aR>0);return e.reverse().join("");};var aI=(function(){var aP=new Date();var aO=Date.parse("Jan 1 "+aP.getFullYear());var e=aP.getTime()-aO;return X(e,62);}());var m=function(){var aR=0,aP={};var aO=function(aT,aU,aS){if(typeof aT.output==="undefined"){throw new Error("item with id "+aU+' must have "output" method');}this.item=aT;this.id=aU||++aR;this.props=aS||{};this.output=function(){return(typeof aT.output==="function")?aT.output():aT.output;};};var e=function(aU){var aV,aS,aT=[];for(aV in aP){if(aP.hasOwnProperty(aV)){aS=aU(aV,aP[aV]);if(aS){aT.push(aS);}}}return aT;};var aQ=function(aU,aV,aT){var aS=new aO(aU,aV,aT||{});aP[aS.id]=aS;};return{addItem:aQ,iterate:e,getItem:function(aS){return aP[aS];}};};m=new m();var h=function(){var aT="Shockwave",aQ="Flash",aO=aT+aQ+"."+aT+aQ,aS=aT+" "+aQ;var aP=function(){var aX=function(aY){return aY.replace(/\D+/g,",").match(/^,?(.+),?$/)[1].split(",").join(".");};try{try{var aV=new ActiveXObject(aO+".6");try{aV.AllowScriptAccess="always";}catch(aW){return"6";}}catch(aW){}return aX(new ActiveXObject(aO).GetVariable("$version"));}catch(aW){try{if(navigator.mimeTypes[am].enabledPlugin){if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return aX((navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description);}return aX((navigator.plugins[aS+" 2.0"]||navigator.plugins[aS]).description);}}catch(aW){}}return"0";};var aU=function(){var aV=5;e=e||aR();if(e==="i"){if(window.atob){aV=10;}else{if(document.addEventListener){aV=9;}else{if(window.JSON&&document.querySelector){aV=8;}else{if(window.XMLHttpRequest){aV=7;}else{if(document.compatMode){aV=6;}}}}}}else{aV="na";}return aV;};var e=false;var aR=function(){var aV="u";if(typeof window.opera!==E&&typeof window.opera.buildNumber!==E){aV="o";}else{if(typeof window.mozInnerScreenY!==E){aV="g";}else{if(typeof window.chrome!==E&&typeof window.chrome.app!==E){aV="c";}else{if(typeof window.WebKitPoint!==E){aV="w";}else{if(typeof window.attachEvent!==E){aV="i";}}}}}return aV;};return{getFlashVersion:aP,getBrowserVersion:aU,getBrowser:function(){e=e||aR();return e;}};}();var ay;var al=function(){var aW=function(aZ){var aY={a:"top.location.href",b:"parent.location.href",c:"parent.document.referrer",d:"window.location.href",e:"window.document.referrer",f:"jsref",g:"ffCheck -- firefox result",q:"ffCheck -- parent.parent.parent... result"};ar.groupCollapsed("Detection Results");var a0="";for(var e in aZ){row=aZ[e];a0+=row.key+": "+decodeURIComponent(row.val)+"\n";}ar.log(a0);ar.dir(aY);ar.groupEnd();};var aT=function(){var aY={g:"",q:""};try{aY.q=window.parent.parent.parent.parent.parent.parent.parent.parent.parent.parent.location.href;}catch(a0){var aZ=a0.message;var a1=aZ.substring(aZ.lastIndexOf("<")+1,aZ.lastIndexOf(">"));if(typeof a1!=E&&aX()){aY.g=a1;}}return aY;};var aX=function(){var aZ=3;var aY=6;var a2=13;var a7=false;if(typeof window.navigator!==E&&typeof window.navigator.userAgent!==undefined){var a0=window.navigator.userAgent;var e=window.navigator.userAgent.match(/Firefox\/([\.0-9]+)/);if(e!==null&&e.length==2){var a4=e[1];var a1=a4.split(".");var a5=a1[0];if(parseInt(a5,10)==aZ){var a3=a1[1];if(parseInt(a3,10)<=aY){if(a1.length==3){var a6=a1[2];if(parseInt(a6,10)<=a2){a7=true;}}else{a7=true;}}}}}return a7;};var aP=function(e){for(var aZ in e){if(e.hasOwnProperty(aZ)){var aY=e[aZ];if(aY===""||aY==="null"||aY===E||aY===null||typeof aY===E){delete e[aZ];}}}return e;};var aV=function(aZ){var e={};var a0,a1;for(a1 in aZ){if(aZ.hasOwnProperty(a1)){a0=aZ[a1];if(typeof e[a0]==E){e[a0]=a1;}else{e[a0]+=a1;}}}var aY={};for(a1 in e){if(e.hasOwnProperty(a1)){a0=e[a1];aY[a0]=a1;}}return aY;};var aR={};try{aR.a=encodeURIComponent(top.location.href);}catch(aU){}try{aR.b=encodeURIComponent(parent.location.href);}catch(aU){}if(T){try{aR.c=encodeURIComponent(parent.document.referrer);}catch(aU){}try{aR.e=encodeURIComponent(window.document.referrer);}catch(aU){}}try{aR.d=encodeURIComponent(window.location.href);}catch(aU){}try{aR.f=encodeURIComponent(aG.jsref);}catch(aU){}try{var aQ=aT();aR.g=encodeURIComponent(aQ.g);aR.q=encodeURIComponent(aQ.q);}catch(aU){}aR=aP(aR);aR=aV(aR);var aS=[];for(var aO in aR){if(aR.hasOwnProperty(aO)){aS.push({key:aO,val:aR[aO]});}}aS.sort(function(aY,e){return(aY.val.length>e.val.length)?1:(aY.val.length<e.val.length)?-1:0;});aW(aS);return aS;};var z=document.getElementsByTagName("script");var at=z[z.length-1];var aM=at.parentNode;var C=null;var aK=false;var ak={SPAN:"s",AD_HUNT:"a",IFRAME:"i"};var k={LOCATION:"l",OBSTRUCTION:"o",FOCUS:"f"};var w=function(){var aW,a0,aX,aU;var aZ=C;if(aG.mode=="jsli"){return{viewState:"na",embedded:T};}try{aW=ap();a0=aN();if(aW===-1||a0===-1){return{viewState:"na",embedded:T};}else{var aS=ab(aW.x,aW.x+aW.width,a0.x,a0.x+a0.width);var aQ=ab(aW.y,aW.y+aW.height,a0.y,a0.y+a0.height);var aT=(aS<=0||a0.width<=0)?0:J(aS/a0.width*100);var aR=(aQ<=0||a0.width<=0)?0:J(aQ/a0.height*100);aX=J(aT*aR/100);}}catch(aY){an.add(an.codes.GET_SCREEN_LOC_GET_DIMENSIONS);ar.trace();ar.error(aY);}try{if(typeof window.mozInnerScreenY==E&&typeof window.screenY!=E&&a0.y==aW.y){aU="na";}else{if(aX>=75){aU="inView";}else{if(aX<=25){aU="outOfView";}else{if(aX>=50){aU="partialViewPlus";}else{aU="partialViewMinus";}}}}}catch(aY){an.add(an.codes.GET_SCREEN_LOC_PIV_CALC);ar.error(aY);}var aP=[];if(aU=="outOfView"){aP.push(k.LOCATION);}var aO=U(a0);if(aO===true){aU="outOfView";aP.push(k.OBSTRUCTION);aO=1;}else{if(aO===false){aO=0;}else{aO="na";}}var aV=G();if(aV===true){aU="outOfView";aP.push(k.FOCUS);aV=1;}else{if(aV===false){aV=0;}else{aV="na";}}if(C&&aZ!==C){ar.log("New Engagement Node:",C);}return{winDimensions:aW,adDimensions:a0,viewState:aU,percentInView:aX,reason:aP.join("."),obstructed:aO,tabHidden:aV};};var ap=function(){var aP,aT,aQ,aR;try{if(l){aP=aT=0;if(typeof top.document.documentElement.clientWidth!=E){aQ=top.document.documentElement.clientWidth;}if(typeof top.document.documentElement.clientHeight!=E){aR=top.document.documentElement.clientHeight;}}else{if(typeof window.screenX!=E){aP=window.screenX;}if(typeof window.screenY!=E){aT=window.screenY;}if(typeof window.outerWidth!=E){aQ=window.outerWidth;}if(typeof window.outerHeight!=E){aR=window.outerHeight;}}}catch(aS){an.add(an.codes.GET_WIN_DIMENSIONS);ar.exception(aS);}var aO;if(isNaN(aP)||isNaN(aT)||isNaN(aQ)||isNaN(aR)){aO=-1;}else{aO={x:J(aP),y:J(aT),width:J(aQ),height:J(aR)};}return aO;};var aN=function(){var aU,aT,aX,aP,aO,aV;if(typeof aM.getBoundingClientRect!=E){aV=aM.getBoundingClientRect();aV={x:J(aV.left),y:J(aV.top),width:J(aV.width),height:J(aV.height)};}if(T){aO=ak.IFRAME;try{if(l){var aW=ah(window);aU=aW.left;aT=aW.top;}else{if(typeof window.mozInnerScreenX==E){aU=window.screenLeft;aT=window.screenTop;}else{aU=J(window.mozInnerScreenX);aT=J(window.mozInnerScreenY);}}if(typeof window.innerWidth!=E){aX=window.innerWidth;aP=window.innerHeight;}else{if(aq&&typeof aq.clientWidth!=E){aX=aq.clientWidth;aP=aq.clientHeight;}}}catch(aR){an.add(an.codes.GET_AD_DIMENSIONS);ar.exception(aR);}}else{if(!aK){aO=ak.AD_HUNT;var aY=D(aM);if(aw(aY)>1){C=aY;aK=true;}else{aO=ak.SPAN;if(!C){C=document.createElement("span");av(C.style,{width:"0px",height:"0px",display:"block",overflow:"hidden",visibiility:"hidden"});C.innerHTML=".";aM.insertBefore(C,at.nextSibling);}}}var aQ=C.getBoundingClientRect();var aS=F(C);aU=aQ.left;aT=aQ.top;aX=aS.w<aQ.width?aS.w:(aQ.width||1);aP=aS.h<aQ.height?aS.h:(aQ.height||1);}var aZ;if(isNaN(aU)||isNaN(aT)||isNaN(aX)||isNaN(aP)){aZ=-1;}else{aZ={x:J(aU),y:J(aT),width:J(aX),height:J(aP),method:aO,container:aV};}return aZ;};var F=function(aP){var e=10000,aO=10000,aQ;do{aP=aP.parentNode;aQ=aP.getBoundingClientRect();e=aQ.width<e?aQ.width:e;aO=aQ.height<aO?aQ.height:aO;}while(aP!==aM);return{w:J(e),h:J(aO)};};var D=function(aW){var aY="iframe,img,a,object,embed,div".split(",");var aT=[];var aU,aO=-1;var aS;for(aS=0,len=aY.length;aS<len;aS++){var aP=aY[aS];var aV=aW.getElementsByTagName(aP);if(aV.length){for(var aR=0,e=aV.length;aR<e;aR++){aT.push(aV[aR]);}}}if(aT.length){for(aS=0,len=aT.length;aS<len;aS++){var aX=aT[aS];var aQ=aw(aX);if(aQ>aO){aU=aX;aO=aQ;}}}if(typeof aU==E){return null;}else{if(typeof aU.nodeName!=E&&aU.nodeName=="DIV"){return D(aU);}else{return aU;}}};var aw=function(aP){var aO=-1;if(aP){var e=aP.getBoundingClientRect();aO=e.width*e.height;}return aO;};var ah=function(aR,aU){if(typeof aU===E){aU={top:0,left:0};}var aT=aR.parent.document.getElementsByTagName("iframe");var aS;var aQ=false;for(var aO=0,e=aT.length;aO<e;aO++){aS=aT[aO];if(aS.contentWindow==aR){aQ=true;break;}}if(aQ){var aP=aS.getBoundingClientRect();aU.left+=aP.left;aU.top+=aP.top;if(aR!==top){ah(aR.parent,aU);}}return aU;};var U=function(aQ){var e=null;if(aK&&!T&&C&&aQ&&typeof document.elementFromPoint!=E){var aP=Math.floor(aQ.x+(aQ.width/2));var aO=Math.floor(aQ.y+(aQ.height/2));var aR=document.elementFromPoint(aP,aO);if(aR!==null){e=aR!==C;}}return e;};var G=function(){var e=null;if(typeof document.hidden!=E){e=document.hidden;}else{if(typeof document.mozHidden!=E){e=document.mozHidden;}else{if(typeof document.msHidden!=E){e=document.msHidden;}else{if(typeof document.webkitHidden!=E){e=document.webkitHidden;}}}}return e;};var ab=function(aO,e,aQ,aP){return Math.min(e,aP)-Math.max(aQ,aO);};var a={UNLOAD:"u",PING:"p",ADTALK:"a",VIEWABILITY_READY:"v"};var ai;var i;var aL=[];var az=false;var v=250;var aJ=1000;var O=function(){var aO=(aG.enagementDelay.indexOf("-")!==-1)?aG.enagementDelay.split("-"):[aG.enagementDelay],e=0;for(;e<aO.length;e++){aO[e]=aO[e]*aJ;}return aO;}();ar.groupCollapsed("Engagement Settings");ar.log("pingTimes:",O,"pingTime:",O[0],"engagementCodes:",a);ar.groupEnd();var Y=function(aR,aW){ar.group("Send "+aW+"-type DT Call");var aT="";if(s&&(aW===a.ADTALK||ai!=="na")){var aX=o();if(typeof aW==E){aW=a.UNLOAD;}if(aW===a.UNLOAD&&az){return;}try{if(aG.mode=="jspix"||aG.mode=="jload"){aT=aG.requrl;}else{var a0=aG.adsafeSrc.indexOf("/",9);aT=aG.adsafeSrc.substr(0,a0)+"/";}var a1=M();var aY="asId="+aG.asid;var e=O.length&&O[0]/aJ;if(aW===a.UNLOAD){e=-1;}else{if(aW===a.ADTALK){e=-2;}else{if(aW===a.VIEWABILITY_READY){e=-3;}}}var aS=(c.time!==-1)?",hoverTime:"+c.time+",mouseBox:"+c.getBoundingBoxString():"";var aV=(an.hasErrors())?",e:"+an.toString():"";var aQ="";m.iterate(function(a3,a2){if(!a2.props.type||a2.props.type===aW){aQ+=","+a3+":"+a2.output();ar.pm(a3+" call: "+a2.output());}});var aP="&br="+h.getBrowser();var aZ="&tv={c:"+aI+",pingTime:"+e+",time:"+aX+",type:"+aW+a1+aS+aV+aQ+"}";var aO=aT+"dt?"+aY+aZ+aP;aO+="&adsafePrivacyPolicy=http://adsafemedia.com/privacy-policy";ar.info("Sending "+aW+"-type dt data to: "+aO);Z(aO);if(aW===a.UNLOAD){az=true;}}catch(aU){an.add(an.codes.PHONE_HOME);ar.error(aU);}}ar.groupEnd();};var A=function(){var aO={inView:0,outOfView:0,partialViewPlus:0,partialViewMinus:0};var aR,aT,aP,aS=0;for(var aQ=0,e=aL.length;aQ<e;aQ++){aR=(aQ===0)?i:aL[aQ-1].sl;aT=aL[aQ].t;aO[aR]+=aT-aS;aS=aT;}aT=o();aP=(e===0)?aT:aT-aL[e-1].t;aO[ai]+=aP;return aO;};var M=function(){var aO=A();var aP=10;var e="";if(aL.length){e=",slTimes:{i:"+aO.inView+",o:"+aO.outOfView+",pp:"+aO.partialViewPlus+",pm:"+aO.partialViewMinus+"}";e+=",slEvents:["+aL.slice(-aP).join(",")+"]";e+=",slEventCount:"+aL.length;ar.groupCollapsed("Engagement Events");ar.dir(aO);ar.dir(aL);ar.groupEnd();}else{ar.info("No events.");}return e;};var p=function(aP){var aQ=(typeof aP==E)?o():aP;var aO=aL.length;var e=(aO===0)?aQ:aQ-aL[aO-1].t;return e;};var S=function(aO,aW,aV){var e;var aQ=function(aX,aY){return'<param name="'+aX+'" value="'+aY+'"/>';};var aT=function(aY,aX){return aY+'="'+aX+'" ';};var aS=function(){var a0,a4=aG.adsafeSrc.indexOf("/",9),aY=aG.adsafeSrc.substr(0,a4),a5=aY.split("//")[0]+"//",aX=aY.split("."),a1=aX.shift(),aZ="static."+aX.join("."),a6=aG.cocaPuffsPath||(a5+aZ+"/detector.pix"),a3=aQ("allowscriptaccess","always"),a2=aQ("movie",a6)+aQ("play","true")+aQ("loop","true");if(h.getBrowser()==="i"){if(f("cachebust")){a6+="?t="+y;}a0=document.createElement("div");a0.innerHTML="<object "+aT("id","blag"+y)+aT("classid","clsid:D27CDB6E-AE6D-11cf-96B8-444553540000")+aT("type",am)+aT("data",a6)+">"+a2+a3+"</object>";e=a0.firstChild;}else{e=document.createElement("object");e.data=a6;e.type=am;e.innerHTML=a3;}e.style.position="absolute";e.style.width="1px";e.style.opacity="0";e.style.height="1px";return e;};var aP=function(aY,aX,a0){var aZ=aS();aZ.style.left=aX;aZ.style.top=a0;aY.appendChild(aZ);};var aR=function(){return aU()&&e.isInView();};var aU=function(){return e&&typeof e.isInView==="function";};aP(aO,aW,aV);return{isInView:aR,isNotReadyToReport:function(){return !aU();}};};var aE=function(aT,aP,aS){var aQ=new aT(document.body,((typeof window.innerWidth!==E&&window.innerWidth)||aq.clientWidth)/2,((typeof window.innerHeight!==E&&window.innerHeight)||aq.clientHeight)/2);var aR,aO,aV=5,e=0;aR=setInterval(function(){var aW=!aQ.isNotReadyToReport();if(aW&&!aO){aO=true;aS();clearInterval(aR);}else{if(++e===aV||aO){clearInterval(aR);}}},50);var aU=function(){var aZ=!aQ.isNotReadyToReport();var aX=aQ.isInView();var aW=aX?"inView":"outOfView";var aY=aX?100:0;if(aZ&&!aO){aO=true;aS();}return{str:aZ?aW:"na",pct:aZ?aY:-1};};return{checkViewable:aU};};var af,aC=0,ax=0,K=f("consecutive")?aJ:1,R=o();var au=function(){var aO=function(){au();if(f("viewabilityready")){Y(null,a.VIEWABILITY_READY);}};var aS,aR,e=o()-R,aU=w(),aQ=h.getBrowser()!=="g"&&T&&!l;if(f("cocoapuffs")&&aQ){af=af||new aE(S,(aM||document.getElementsByTagName("body")[0]),aO)||{};aS=af.checkViewable();if(aU.tabHidden!==1||aS.str==="na"){aU.viewState=aS.str;aU.percentInView=aS.pct;}}else{if(aQ){aU.viewState="na";aU.percentInView=-1;}}var aT=aU.viewState;if(ai!=aT){ar.info("New location: "+aT);var aP=I(aU,ai);aL.push(aP);ai=aT;ar.pm("percentInView:"+aU.percentInView+",viewState:"+ai+M());}if(ai==="inView"||ai==="partialViewPlus"){ax+=e;aR=ax-e<K;if(ax>K){aC+=aR?ax:e;}}else{ax=0;}if(O.length&&aC>=O[0]){Y(null,a.PING);O.shift();}R=o();};var I=function(aO,e){var aQ=o();var aP={t:aQ,sl:aO.viewState,details:aD(aO)};aP.toString=function(){return"{t:"+this.t+",sl:"+this.sl+this.details+"}";};ar.log("creating event: "+aP);return aP;};var aB=function(){var aO=false;var e;if((aG.allowEnagement==="true")&&typeof document.addEventListener=="function"){aH=false;if(document.readyState=="complete"||document.readySate=="loaded"){aF(Q);}else{document.addEventListener("DOMContentLoaded",Q,false);}}else{e=setInterval(function(){if(document.body){aq=(document.documentElement&&(typeof document.documentElement.clientWidth!==E)&&document.documentElement)||document.body;clearInterval(e);Q();}},50);}};var Q=function(e){ar.info("Page ready.");aH=true;if(s){i=ai;ar.pm(i);au();setInterval(au,v);if(typeof window.addEventListener=="function"){ar.info("Adding beforeunload event.");window.addEventListener("beforeunload",Y,false);}}};var c={time:-1,enterTime:null,min:null,max:null,trackMaxMin:null,mouseLeave:function(aO){var e=new Date().getTime()-c.enterTime;c.time+=e;W("mousemove",c.move);ar.log("mouseLeave - time:",e,c.time,"bounding box:",c.getBoundingBoxString(),aO);},mouseEnter:function(e){ar.log("mouseEnter",e);if(c.time===-1){c.time=0;}c.enterTime=new Date().getTime();P(window,"mousemove",c.move);},getBoundingBoxString:function(){var e;if(c.min&&c.max){e=c.min.x+"-"+c.min.y+"-"+c.max.x+"-"+c.max.y;}else{e="-1";}return e;},move:function(e){if(c.trackMaxMin===null){c.trackMaxMin=c.min&&c.max&&typeof e.clientX!=E&&typeof e.clientY!=E;}if(c.trackMaxMin){if(e.clientX<c.min.x){c.min.x=e.clientX;}if(e.clientY<c.min.y){c.min.y=e.clientY;}if(e.clientX>c.max.x){c.max.x=e.clientX;}if(e.clientY>c.max.y){c.max.y=e.clientY;}}},init:function(){if(f("mousetrack")){if(T){P(window,"mouseenter",this.mouseEnter);P(window,"mouseleave",this.mouseLeave);if(typeof(window.innerWidth)!=E&&typeof(window.innerHeight)!=E){this.min={x:window.innerWidth,y:window.innerHeight};this.max={x:0,y:0};}}}}};var u=function(aQ){var aR,aP,e;switch(aG.mode){case"jss":aR='<script type="text/javascript"';e="<\/script>";break;case"jsi":aR='<iframe width="100%" height="100%" frameborder="0" vspace="0" hspace="0" scrolling="no" marginheight="0" marginwidth="0"';e="</iframe>";break;}var aO=aa(aQ);aO+=ac(aO.length,false);aP=' src="'+aO+'">';ar.info("writeOut: "+aR+aP+e);document.write(aR+aP+e);};var aa=function(aO){ar.groupCollapsed("getFWUrl");var e=aG.adsafeSrc;e+=aG.adsafeSep;ar.log("base url: "+e);ar.log("length: "+e.length);ar.group("Getting urls and types:");e+=n(aO,e.length);ar.groupEnd();ar.info("final: "+e);ar.log("length: "+e.length);ar.groupEnd();return e;};var n=function(aP,aT){ar.groupCollapsed("Get URLs & Types");ar.log("lengthSoFar: "+aT);if(aT>=aj){return"";}var aO="";var aW=aP.length;var aX="adsafe_url=";var aU="&adsafe_type=";var aV=aX.length+aU.length;var aS,aY;var e=false;for(aS=0;aS<aW;aS++){aY=aP[aS];if(aY.key.indexOf("q")!=-1){ar.log("found q");if(aO.length+aT+aV+aY.val.length+aY.key.length+1<=aj){ar.log("adding it");aO+=ae(aY,"");e=true;}else{ar.log("but did not add it");}}else{if(aY.key.indexOf("g")!=-1){ar.log("found g");if(aO.length+aT+aV+aY.val.length+aY.key.length+1<=aj){ar.log("adding it");aO+=ae(aY,"");e=true;}else{ar.log("but did not add it");}}}}for(aS=0;aS<aW;aS++){aY=aP[aS];if(aY.key.indexOf("g")===-1&&aY.key.indexOf("q")===-1){if(aO.length+aT+aV+aY.val.length+aY.key.length+1<=aj){var aR=(e)?1:aS;var aQ=(aR>0)?"&":"";ar.log("adding "+aY.key);aO+=ae(aY,aQ);}else{ar.log("skipping "+aY.key);}}}ar.groupEnd();return aO;};var ae=function(e,aP){var aO=aP+"adsafe_url="+e.val;aO+="&adsafe_type="+e.key;ar.log("- "+aO);return aO;};var x=function(aQ){var aO=aG.requrl;if(aG.reqquery.length>0){aO+="?"+aG.reqquery;}var aP=n(aQ,aO.length+1);if(aP!==""){aO+="&"+aP;}aO+=ac(aO.length,true);var e='<img src="'+aO+'"/>';ar.info("Image tag: "+e);ar.log("final url length: "+aO.length);document.write(e);};var ag=function(aP){var e=aG.requrl;if(aG.reqquery.length>0){e+="?"+aG.reqquery;}var aO=n(aP,e.length+1);if(aO!==""){e+="&"+aO;}e+=ac(e.length,true);Z(e);ar.info("Image url: "+e);ar.log("final url length: "+e.length);};var ac=function(aS,aX){ar.group("Add JS Info");var aY="";var aW=w();aW.viewState=h.getBrowser()!=="g"&&T&&!l?"na":aW.viewState;ai=aW.viewState;ar.info("Screen Location Results");ar.dir(aW);var aO="&adsafe_jsinfo=c:"+aI+",sl:"+aW.viewState+",em:"+T+",fr:"+l;var aP=false;if(aY.length+aS+aO.length<=aj){ar.info("Adding locInfo.viewState");aY+=aO;aP=true;}if(aP){var aR=",pt:"+aG.enagementDelay;var e=aW.viewState!="na"?aD(aW):"";if(aY.length+aS+e.length+aR.length<=aj){ar.info("Adding detailed locInfo");aY+=e+aR;}var aV=",br:"+h.getBrowser()+",fv:"+h.getFlashVersion()+",bv:"+h.getBrowserVersion();if(aY.length+aS+aV.length<=aj){ar.info("Adding SAD param");aY+=aV;}var aU=",id:"+aG.asid;if(aY.length+aS+aU.length<=aj){ar.info("Adding impression id param");aY+=aU;s=true;}m.iterate(function(a2,a1){var aZ,a0=aS+aY.length;aZ=","+a2+":";aZ+=a1.output();ar.pm("AdTalk initial call: "+a1.output());if(a0+aZ.length<=aj){aY+=aZ;}});if(an.hasErrors()){ar.warn("Errors:",an,an.toString());var aT=",e:"+an.toString();if(aY.length+aS+aT.length<=aj){ar.info("Adding error codes");aY+=aT;}}var aQ=",v:"+B;if(aY.length+aS+aQ.length<=aj){ar.info("Adding version param");aY+=aQ;}}ar.groupEnd();return aY;};var aD=function(aV){var aY="";try{var aQ=function(e){if(typeof e!==E&&typeof e.x!==E&&typeof e.y!==E&&typeof e.width!==E&&typeof e.height!==E){return e.x+"."+e.y+"."+e.width+"."+e.height;}return"";};var aU=function(e,aZ){return","+e+":"+aZ;};var aS=aV.winDimensions;if(typeof aS!=E){try{aY=aU("wc",aQ(aS));}catch(aT){throw"wc";}}var aX=aV.adDimensions;if(typeof aX!=E){try{aY+=aU("ac",aQ(aX));if(typeof aX.method=="string"){aY+=aU("am",aX.method);}if(typeof aX.container=="object"){aY+=aU("cc",aQ(aX.container));}}catch(aT){throw"ad";}}var aR={piv:"percentInView",obst:"obstructed",th:"tabHidden",reas:"reason"};for(var aW in aR){try{if(aR.hasOwnProperty(aW)){var aP=aR[aW];if(typeof aV[aP]!==E){aY+=aU(aW,aV[aP]);}}}catch(aT){throw aW;}}}catch(aT){an.add(an.codes.LOCATION_DETAILS);var aO=(typeof aT==="string")?aT:(typeof aT.type!=="undefined")?aT.type:"unk";aY+=",detErr:"+aO;ar.error(aT);}return aY;};var d=function(aR){var aP;var aO=aR.length;var e=aR[aO-1];for(aP=0;aP<aO;aP++){var aQ=aR[aP];if(aQ.key.indexOf("g")!==-1){e=aQ;}}return e;};var Z=function(aO){var e=new Image();e.onload=function(){ar.info("Image loaded: "+aO);};e.src=aO;};var aA=function(){ar.groupCollapsed("Checking for kill phrases...");var aW=false;try{if(typeof aG!=E&&typeof aG.killPhrases!=E&&aG.killPhrases!==""){var aV=aG.adsafeSrc;if(aV===""){aV=aG.requrl+aG.reqquery;}var aS=aG.killPhrases.split(",");var aQ="";for(var aR=0,aT=aS.length;aR<aT;aR++){var aO=decodeURIComponent(aS[aR]).replace(/^\s+|\s+$/g,"");if(aV.search(aO)!==-1){aQ=aO;aW=true;}}var aP=(aW)?'found ("'+aQ+'").':"not found.";ar.log('Kill phrases ("'+aG.killPhrases+'") '+aP);}else{ar.log("Kill phrase empty or not found.");}}catch(aU){an.add(an.codes.KILL_IT);ar.exception(aU);}ar.groupEnd();return aW;};var V=(typeof JSON!==E&&typeof window.postMessage!==E);var L=function(){var aO={};var aW=[];if(!V){return;}var aR=[];var aQ=function(aZ){var aX,aY,a0;aZ=aZ||aG;if(aZ.reqquery){aX=aZ.reqquery.split("anId=")[1].split("&")[0];}else{aY=aZ.adsafeSrc.split("/");aX=aY[5]+"-"+aY[6];}a0={adId:aX,adSafeId:aZ.asid};aR.push(a0);return a0;};var aP=function(){var aY=[];var aX={};var a0={noMe:true};var a1=function(a2){aY.push(a2);aX[a2.pageId]=a2;if(a2.isMe){a0=a2;}};var aZ=function(){var a3,a2,a6,a5,a4=[];for(a3=0;a3<aY.length;a3++){a6=aY[a3];if(a6.isLeaf||a6.isMe||a6.selfDescription!==undefined){a5="";for(a2=0;a2<a6.position.length;a2++){a5+=(Number(a6.position[a2])+1).toString(36);}a5+=(a6.isMe)?"*":"";a5+=(a6.adProxies.length!==0)?"."+a6.adProxies[0].adId:"";a4.push(a5);}}return X(a0.unifiedId,62)+"+"+a4.join("|");};return{addFrame:a1,list:aY,lookup:aX,me:function(){return a0;},output:aZ};};aP=new aP();var aV=function(a0,aZ){var aX=a0===window;var aY={position:aZ.slice(0),pageId:aZ.join("-"),domObj:function(){return a0;},isMe:aX,isLeaf:!a0.frames.length,adProxies:aX?aR:[],selfDescription:undefined,unifiedId:y};aY.toString=function(){return JSON.stringify(aY);};aY.addDescription=function(a1){aY.selfDescription=a1;aY.adProxies=a1.adProxies;};aP.addFrame(aY);return aY;};var e=function(){var aX=function(a3,aY){var a1=aY.length,a0=a3.frames,a2=new aV(a3,aY);if(!a2.isLeaf){for(var aZ=0;aZ<a0.length;aZ++){aY[a1]=aZ;aX(a0[aZ],aY);}aY.pop();}};return{start:function(){aX(top,[0]);}};};e=new e();var aS=function(aZ){var aY=function(a0,a1){a1=a1||"*";aZ.getMessageTime=new Date().getTime();delete aX.updateMessage;delete aX.sendMessage;a0.postMessage(JSON.stringify(aX),a1);};var aX={srcId:aG.asid,srcKey:aG.asid.split("-")[2],srcStart:g,getMessageTime:undefined,replyTo:document.location,sendMessage:aY,updateMessage:function(a0){aZ=a0(aZ);},messageContent:aZ||{}};return aX;};var aT=function(){var aY=[];var aZ=function(){P(window,"message",function(a6){var a2,a5,a3,a1,a4=aP.me();try{a2=JSON.parse(a6.data);a5=a2.messageContent;if(aG.asid.split("-")[2]!==a2.srcKey||!a2.hasOwnProperty("messageContent")){return;}if(a5.unifiedId<a4.unifiedId){a4.unifiedId=a5.unifiedId;}}catch(a7){return;}aY.push(a2);try{if(a5.expectedPageId!==aP.me().pageId){an.add(an.codes.ADTALK_DUBIOUS);}else{a1=aP.lookup[a5.self.pageId];if(a1===undefined||a1.selfDescription===undefined){a1=a1||new aV(a6.source,a5.self.pageId.split("-"));a0(a1);}a1.addDescription(a5.self);}}catch(a7){an.add(an.codes.ADTALK_DUBIOUS);}});};var a0=function(a1){var a3=aP.me();var a2=new aS({self:a3,expectedPageId:a1.pageId,unifiedId:a3.unifiedId});a2.sendMessage(a1.domObj());};var aX=function(){var a2,a1;for(a2=0;a2<aP.list.length;a2++){a1=aP.list[a2];if(!a1.isMe){a0(a1);}}};return{sendMessages:aX,listen:aZ};};aT=new aT();var aU=function(){var aX=new aQ();};return{sendMessages:aT.sendMessages,listen:aT.listen,findFrames:e.start,createAdProxy:function(aY){var aX=new aQ(aY);return aX;},getFrameStore:function(){return aP;}};}();var b=function(aO){switch(aG.mode){case"jsli":var e=aa(aO);e+=ac(e.length,false);Z(e);break;case"jspix":x(aO);break;case"jload":ag(aO);break;default:u(aO);break;}};var q=function(){var aO;if(!aA()){if(aG.useAdTalk==="true"&&V){try{L.createAdProxy(aG);L.findFrames();L.listen();L.sendMessages();m.addItem(L.getFrameStore(),"fm");}catch(aP){an.add(an.codes.ADTALK_GENERAL);}}aB();c.init();ay=al();b(ay);if(aG.adTalkDtCall==="true"&&V){aO=new Date().getTime();aF(function(){aF(function(){var e={output:new Date().getTime()-aO};m.addItem(e,"sinceFw",{type:a.ADTALK});if(typeof aH!=="undefined"){m.addItem({output:aH},"readyFired",{type:a.ADTALK});}if(r){ar.inDoc(L.getFrameStore().output(),2000);}Y(null,a.ADTALK);});});}}};q();aG.NS={Output:m};})(adsafeVisParams,new Date().getTime());
