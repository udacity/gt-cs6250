function addGlobalStyle(css){var head=document.getElementsByTagName("head")[0];
if(!head){return;
}var style=document.createElement("style");
style.type="text/css";
style.innerHTML=css;
head.appendChild(style);
}hoverOverImageTriggersTitleHover=function(){var $=jQuery;
$("div.results > div.result > div.image").each(function(){$(this).hover(function(){$(this).parent().find("div.data > div.title a.title").addClass("titleHover");
},function(){$(this).parent().find("div.data > div.title a.title").removeClass("titleHover");
});
});
};
processAddToWishListBtns=function(){var forms=jQuery(".addtocart form");
forms.each(function(i){var form=jQuery(this);
var wbtn=form.find("input[name*='wishlist']");
var h=wbtn.attr("height");
var w=wbtn.attr("width");
var b=wbtn.attr("border");
var s=wbtn.attr("src");
wbtn.remove();
var wimg='<div class="addToWL"><img '+"height="+h+" width="+w+" border="+b+" src="+s+"/></div>";
form.append(wimg);
wimg=form.find("img");
var wdiv=form.find(".addToWL");
wimg.click(function(){var url=form.attr("action");
var sid=form.find("input[name*='session']").attr("value");
var oid=form.find("input[name*='offer']").attr("value");
var asin=form.find("input[name*='asin']").attr("value");
var op=wbtn.attr("name");
var pdata=op+"="+"&offeringID.1="+oid+"&asin.1="+asin+"&session-id="+sid;
wdiv.addClass("addedToWL");
wdiv.html(srPg.addingTxt);
jQuery.ajax({type:"POST",url:url,data:pdata,success:function(response){var fbk=srPg.addedToTxt+"<a style='text-decoration: underline;' href='"+srPg.wishListUrl+"'>"+srPg.wishListTxt+"</a>";
wdiv.html(fbk);
},error:function(){wdiv.html(srPg.cantAddTxt);
}});
return false;
});
});
};
processDigitalMusicAddToCart=function(){var addToCart=function(form,button,asin){if(this[asin]||!form){return false;
}var messageDiv=jQuery(".atcb",form);
var processing=jQuery(".atcp",form);
var inCart=jQuery(".atci",form);
var postUrl=form.attr("action");
var postParams=form.serialize();
if(!messageDiv||!button||!processing||!inCart||!postUrl||!postParams){return false;
}this[asin]=true;
button.fadeOut("slow").remove();
messageDiv.append(processing);
processing.fadeIn("slow");
jQuery.ajax({type:"POST",url:postUrl,data:postParams,success:function(){processing.fadeOut("slow").remove();
messageDiv.append(inCart);
inCart.fadeIn("slow");
},error:function(){processing.fadeOut("slow").remove();
messageDiv.append(button);
button.fadeIn("slow");
this[asin]=false;
}});
};
var forms=jQuery(".srlBuyButton form");
forms.each(function(){var form=jQuery(this);
var asin=form.attr("id");
asin=asin.replace(/.*_/,"");
var button=jQuery(".atcb input",form);
button.click(function(){addToCart(form,button,asin);
});
});
};
processBestRefinementsFlyout=function(options){var hotspot=jQuery("#bestRefinementsMoreHotspot");
hotspot.removeAmazonPopoverTrigger();
var width=300;
var defaults={showOnHover:true,showCloseButton:false,forceAlignment:true,hoverShowDelay:200,hoverHideDelay:200,localContent:"#bestRefinementsMore_content",location:"bottom",align:"default",width:width,zIndex:200,skin:"default",locationMargin:4,locationOffset:[hotspot.width()-width+35,-1],onShow:function(popover){hotspot.bind("closepopover",function(){popover.close();
});
jQuery("#bestRefinementsMoreHotspot_tab").addClass("bestRefinementsMoreOpen");
return 1;
},onHide:function(popover){hotspot.unbind("closepopover");
jQuery("#bestRefinementsMoreHotspot_tab").removeClass("bestRefinementsMoreOpen");
return 1;
}};
hotspot.amazonPopoverTrigger(jQuery.extend({},defaults,options));
};
processBestRefinementsMore=function(){amznJQ.onReady("popover",function(){var renderOptions={hotspotTabDiv:"#bestRefinementsMoreHotspot_tab",hotspotDiv:"#bestRefinementsMoreHotspot",contentDiv:"#bestRefinementsMore_content",openStyle:"bestRefinementsMoreOpen",locationOffset:35,width:300,topOffset:14,leftOffset:0};
processFlyout(renderOptions);
});
};
processEntityRefinements=function(){amznJQ.onReady("popover",function(){var renderOptions={hotspotTabDiv:"#bestRefinementsMoreHotspot_tab",hotspotDiv:"#entityRefinementsHotspot",contentDiv:"#entityRefinementsMoreContent",openStyle:"bestRefinementsMoreOpen",width:280,locationOffset:30,topOffset:14,leftOffset:-3};
processFlyout(renderOptions);
});
};
processChangeCategoryFlyout=function(options){var $=jQuery,amazonPopoverOptions=options;
var changeCategoryFlyoutDefaults={hotspotId:"changeCategoryHotspot",hotspotTabId:"changeCategoryHotspot_tab",hotspotContentId:"changeCategory_content",hotspotStyleClass:"changeCategoryOpen",makeFlyoutTable:true};
var hotspot=$("#"+changeCategoryFlyoutDefaults.hotspotId);
hotspot.removeAmazonPopoverTrigger();
var defaults={showOnHover:true,showCloseButton:false,forceAlignment:true,hoverShowDelay:200,hoverHideDelay:200,localContent:"#"+changeCategoryFlyoutDefaults.hotspotContentId,location:"bottom",align:"default",width:200,zIndex:200,skin:"default",locationMargin:4,locationOffset:[-20,-4],onShow:function(popover){$("#refinementsOnTop #changeCategoryHotspot").css("padding-top","0px");
hotspot.bind("closepopover",function(){popover.close();
});
var tab=$("#"+changeCategoryFlyoutDefaults.hotspotTabId).addClass(changeCategoryFlyoutDefaults.hotspotStyleClass);
return 1;
},onHide:function(popover){hotspot.unbind("closepopover");
$("#"+changeCategoryFlyoutDefaults.hotspotTabId).removeClass(changeCategoryFlyoutDefaults.hotspotStyleClass);
$("#refinementsOnTop #changeCategoryHotspot").css("padding-top","4px");
return 1;
}};
hotspot.amazonPopoverTrigger($.extend({},defaults,amazonPopoverOptions));
};
processChangeCategory=function(options){amznJQ.onReady("popover",function(){processChangeCategoryFlyout(options);
});
};
processSortFlyout=function(options){var $=jQuery,amazonPopoverOptions=options;
var sortFlyoutDefaults={hotspotId:"kindOfSortHotspot",hotspotTabId:"kindOfSortHotspot_tab",hotspotContentId:"kindOfSort_content",hotspotStyleClass:"kindOfSortOpen",makeFlyoutTable:true};
if(options!==undefined){sortFlyoutDefaults=$.extend(sortFlyoutDefaults,options.sortFlyoutDefaults);
amazonPopoverOptions=$.extend(amazonPopoverOptions,options.amazonPopoverOptions);
}var hotspot=$("#"+sortFlyoutDefaults.hotspotId);
hotspot.removeAmazonPopoverTrigger();
var defaults={showOnHover:true,showCloseButton:false,forceAlignment:true,hoverShowDelay:200,hoverHideDelay:200,localContent:"#"+sortFlyoutDefaults.hotspotContentId,location:"bottom",align:"default",width:300,zIndex:200,skin:"default",locationMargin:4,locationOffset:[-180,0],onShow:function(popover){hotspot.bind("closepopover",function(){popover.close();
});
var tab=$("#"+sortFlyoutDefaults.hotspotTabId).addClass(sortFlyoutDefaults.hotspotStyleClass);
return 1;
},onHide:function(popover){hotspot.unbind("closepopover");
$("#"+sortFlyoutDefaults.hotspotTabId).removeClass(sortFlyoutDefaults.hotspotStyleClass);
return 1;
}};
hotspot.amazonPopoverTrigger($.extend({},defaults,amazonPopoverOptions));
};
processAPSSort=function(options){amznJQ.onReady("popover",function(){processSortFlyout(options);
});
};
processExpandedSort=function(options){var $=jQuery;
var defaults={locationOffset:[3,0],makeFlyoutTable:true};
$.extend(defaults,options);
amznJQ.onReady("popover",function(){var content=$("#sortByBtf_content");
if(content.length){var width=content.width()+80;
var options={sortFlyoutDefaults:{makeFlyoutTable:defaults.makeFlyoutTable},amazonPopoverOptions:{localContent:"#sortByBtf_content",align:"right",width:width,locationOffset:defaults.locationOffset,onFilled:function(popover){}}};
processSortFlyout(options);
}});
};
processSmartAPSSort=function(){var $=jQuery,width=250,hotspotStyleClass="smartAPSOpen",hotspotTabId="smartAPSHotspot_tab",hotspotId="smartAPSHotspot",hotspotContentId="smartAPS_content";
var smartAPSOptions={sortFlyoutDefaults:{hotspotId:hotspotId,hotspotTabId:hotspotTabId,hotspotContentId:hotspotContentId,hotspotStyleClass:hotspotStyleClass,makeFlyoutTable:false},amazonPopoverOptions:{width:width,locationOffset:[0,0],align:"center",closeEventExclude:"MOUSE_LEAVE",closeEventInclude:"CLICK_OUTSIDE",openEventInclude:"CLICK_TRIGGER",showCloseButton:true,onHide:function(){var hotspot=$("#"+hotspotId);
hotspot.unbind("closepopover");
$("#apsSort_seeAllDepartmentClosed, #apsSort_fewDep").show();
$("#apsSort_seeAllDepartmentOpen").css("display","none");
$("#"+hotspotTabId).removeClass(hotspotStyleClass);
return 1;
}}};
amznJQ.onReady("popover",function(){processSortFlyout(smartAPSOptions);
processExpandedSort({locationOffset:[0,0],makeFlyoutTable:false});
});
};
processBestRefinementSeeAllFlyout=function(options){var hotspot=jQuery("#brscSeeAllHotspot");
hotspot.removeAmazonPopoverTrigger();
var width=300;
var defaults={showOnHover:true,showCloseButton:false,forceAlignment:true,hoverShowDelay:200,hoverHideDelay:200,localContent:"#brscSeeAll_content",location:"bottom",align:"default",width:width,zIndex:200,group:"brscSeeAllPopover",skin:"default",locationMargin:4,locationOffset:[hotspot.width()-width+35,-1],onShow:function(popover){hotspot.bind("closepopover",function(){popover.close();
});
var tab=jQuery("#brscSeeAll_hotspot_tab").addClass("brscSeeAllOpen");
return 1;
},onHide:function(popover){hotspot.unbind("closepopover");
jQuery("#brscSeeAll_hotspot_tab").removeClass("brscSeeAllOpen");
return 1;
},onFilled:function(popover){jQuery("#brscSeeAll_seeAllDepartmentClosed a").click(function(){jQuery("#brscSeeAll_seeAllDepartmentClosed").css("display","none");
jQuery("#brscSeeAll_seeAllDepartmentOpen").show();
jQuery.AmazonPopover.updateBacking("brscSeeAllPopover");
return false;
});
jQuery("#brscSeeAll_seeAllDepartmentOpen a").click(function(){jQuery("#brscSeeAll_seeAllDepartmentClosed").show();
jQuery("#brscSeeAll_seeAllDepartmentOpen").css("display","none");
jQuery.AmazonPopover.updateBacking("brscSeeAllPopover");
return false;
});
}};
hotspot.amazonPopoverTrigger(jQuery.extend({},defaults,options));
};
processBestRefinementSeeAll=function(){amznJQ.onReady("popover",function(){processBestRefinementSeeAllFlyout();
});
};
function smartAPSSortUpdate(element){var $=jQuery;
var atag=$("#"+element);
var url=atag.attr("data-url");
var node="";
var queryString=url.substring(url.indexOf("?"));
if(url.indexOf("ref=")!=-1){var reftag=url.substring(url.indexOf("ref="),url.indexOf("?"));
node=reftag.match(/\d+/);
}$("#smartAPS").find("#sortByBtf_content, .sortOption").find("a").each(function(){var sort=$(this).attr("data-sort");
if(sort!==undefined){var targetUrl=this.hash||this.href;
var targetUrlPath=targetUrl.substring(0,targetUrl.indexOf("?"));
targetUrlPath=targetUrlPath.replace(/(sr_st_scat_\w+_)\d+/,"$1"+node);
this.href=targetUrlPath+queryString+"&sort="+encodeURIComponent(sort);
}});
var pop=$("#smartAPSHotspot");
pop.find(".emptyRefinement").text(atag.find(":nth-child(1)").text());
pop.trigger("closepopover");
}function amz_js_PopWin(url,name,options){var ContextWindow=window.open(url,name,options);
ContextWindow.focus();
return false;
}enforceMinWidthForIE=function(divId){var $=jQuery;
var checkWidth=function(){var div=$("#"+divId);
if(div.length&&div.css("min-width")){var minWidth=parseInt(div.css("min-width").replace("px",""));
div.css("width",(div.width()<(minWidth+1))?(minWidth+"px"):"auto");
}};
$(document).ready(checkWidth);
$(window).resize(checkWidth);
};
function onClickSubgroupRefinement(){var thisExpanderSpan=jQuery(this).find("span.expanderImageSprite");
var thisLabelSpan=jQuery(this).find("span.refinementLink");
var thisLabelText=thisLabelSpan.html();
var thisOtherLabelSpan=jQuery(this).find("span.subgroupOtherLabel");
if(thisExpanderSpan.hasClass("collapse")){thisExpanderSpan.removeClass("collapse").addClass("expand");
thisLabelSpan.html(thisOtherLabelSpan.html());
thisOtherLabelSpan.html(thisLabelText);
thisExpanderSpan.parent().parent().children("ul").slideUp("fast");
}else{var actSgrp=jQuery(this).parent().siblings("li").find("a:first span.collapse").parent().parent();
var actExpanderSpan=actSgrp.find("a:first span.expanderImageSprite");
var actLabelSpan=actExpanderSpan.siblings("span.refinementLink");
var actLabelText=actLabelSpan.html();
var actOtherLabelSpan=actExpanderSpan.siblings("span.subgroupOtherLabel");
actExpanderSpan.removeClass("collapse").addClass("expand");
actLabelSpan.html(actOtherLabelSpan.html());
actOtherLabelSpan.html(actLabelText);
thisExpanderSpan.removeClass("expand").addClass("collapse");
thisLabelSpan.html(thisOtherLabelSpan.html());
thisOtherLabelSpan.html(thisLabelText);
actSgrp.children("ul").hide();
jQuery(this).siblings("ul").slideDown("fast");
}}var SearchPageAccessDef=function(){var $=jQuery,atf="atf",btf="btf",nameAttr="name",idAttr="id",resultSelector='div[id^="result_"]',atfResultsSelector="body > #main > #searchTemplate #center "+resultSelector,btfResultsSelector="body > #main > #searchTemplate #centerBelow "+resultSelector,imageSelector="div.image",titleSelector=["h3.newaps","h3.title"],dpLinkSelector=["h3.newaps > a","h3.title > a"],resultCountSelector="#resultCount > span";
function makeResultsSelector(section,suffix){var i,selector="";
if(suffix&&(typeof suffix!=typeof"")){for(i=0;
i<suffix.length;
i++){selector+=makeResultsSelector(section,suffix[i])+", ";
}return selector;
}if(section==atf||!section){selector+=atfResultsSelector;
if(suffix){selector+=" "+suffix;
}selector+=", ";
}if(section==btf||!section){selector+=btfResultsSelector;
if(suffix){selector+=" "+suffix;
}}return selector;
}function makeDecendantSelector(selector){if(typeof selector==typeof""){return selector;
}var i,cmb="";
for(i=0;
i<selector.length;
i++){cmb+=selector[i]+", ";
}return cmb;
}function ancestor(elem,selector){var elem=$(elem);
while(elem.size()&&!elem.is(selector)){elem=elem.parent();
}return elem.size()?elem:undefined;
}function asinResults(section){return $(makeResultsSelector(section));
}function asinList(section){var list=[];
asinResults(section).each(function(){list.push($(this).attr(nameAttr));
});
return list;
}function asinImages(section){return $(makeResultsSelector(section,imageSelector));
}function asinImagesATF(){return asinImages(atf);
}function asinImagesBTF(){return asinImages(btf);
}function asinTitles(section){return $(makeResultsSelector(section,titleSelector));
}function asinResult(elem){return ancestor(elem,resultSelector);
}function asinImage(elem){var asinResult=ancestor(elem,resultSelector);
return asinResult?asinResult.find(makeDecendantSelector(imageSelector)):undefined;
}function asinTitle(elem){var asinResult=ancestor(elem,resultSelector);
return asinResult?asinResult.find(makeDecendantSelector(titleSelector)):undefined;
}function asin(elem){var asinResult=ancestor(elem,resultSelector);
return asinResult?asinResult.attr(nameAttr):undefined;
}function asinDpLinks(section){return $(makeResultsSelector(section,dpLinkSelector));
}function asinIndex(elem){var asinResult=ancestor(elem,resultSelector);
return asinResult?parseInt(asinResult.attr(idAttr).substr(7)):-1;
}function searchAlias(){return $.pageContext?$.pageContext.searchAlias:"";
}function totalResultCount(){var html=jQuery(resultCountSelector).html(),numbers=html?html.match(/([\d,\.]+)/g):[],maxNum=-1,value,i;
for(i=0;
i<numbers.length;
i++){value=parseInt(numbers[i].replace(/[,\.]/g,""));
if(value>maxNum){maxNum=value;
}}return maxNum;
}return{asinImagesBTF:asinImagesBTF,asinImagesATF:asinImagesATF,asinResults:asinResults,asinImages:asinImages,asinTitles:asinTitles,asinResult:asinResult,asinImage:asinImage,asinTitle:asinTitle,asin:asin,asinList:asinList,asinDpLinks:asinDpLinks,asinIndex:asinIndex,searchAlias:searchAlias,asinDisplayIndex:asinIndex,totalResultCount:totalResultCount};
};
function disableImageRotation(asin){if(window.eligileImageRotations){window.eligileImageRotations[asin]=false;
}}var maxRotations=10;
window.SearchImageRotation=function(imageBlock,mainUrl,altImages,section,asin){var ALT_DELAY_TIME=1350;
var ALT_INITIAL_DELAY_TIME=400;
var ALT_FADE_TIME=300;
var alt1=null,alt2=null;
var timeout=null;
var animating_element=null;
var sawNumRotations=0;
var Rotate=function(img_element,new_img_element,image,delay){if(delay==undefined){delay=ALT_INITIAL_DELAY_TIME;
}if(sawNumRotations>=maxRotations||!window.eligileImageRotations[asin]){StopRotation();
return;
}img_element.removeClass("over");
new_img_element.addClass("over").attr("src",image.src).css("opacity",0);
timeout=window.setTimeout(function(){timeout=null;
animating_element=new_img_element.show();
sawNumRotations++;
new_img_element.animate({opacity:1},{duration:ALT_FADE_TIME,complete:function(){animating_element=null;
Rotate(new_img_element,img_element.hide(),image.nextImg,ALT_DELAY_TIME);
}});
},delay);
};
var BuildImageCycle=function(mainImage,altImages){if(!altImages||altImages.length==0){return null;
}var firstImage={src:mainImage};
var images=firstImage;
var current;
for(var i=altImages.length-1;
i>=0;
--i){images={src:altImages[i],nextImg:images};
}firstImage.nextImg=images;
return images;
};
var StopRotation=function(){if(sawNumRotations>0){sawNumRotations=0;
ClogImageRotation.LogCount("sawRotationCount");
ClogImageRotation.LogCount(""+section+"RotationCount");
}if(timeout){window.clearTimeout(timeout);
timeout=null;
}else{if(animating_element){animating_element.stop(true);
}}alt1.add(alt2).fadeOut(ALT_FADE_TIME);
};
var SetupImageRotation=function(imageBlock,mainUrl,altImages){var images=BuildImageCycle(mainUrl,altImages);
alt1=jQuery('<img class="altImage"/>');
alt2=jQuery('<img class="altImage"/>');
imageBlock.children("img.altImage").remove();
imageBlock.append(alt1,alt2);
if(images){var eventIn="mouseenter";
var eventOut="mouseleave";
imageBlock.bind(eventIn,function(){Rotate(alt1,alt2,images);
}).bind(eventOut,function(){StopRotation();
});
}};
SetupImageRotation(imageBlock,mainUrl,altImages);
window.eligileImageRotations[asin]=true;
};
window.setupImageRotation=function(section){if(window.eligileImageRotations==null){window.eligileImageRotations={};
}var sectionUrls=window.srImageUrls&&window.srImageUrls[section];
if(!sectionUrls||jQuery("#searchTemplate div#results-atf-image-rotation").size()==0){return;
}var elements=SearchPageAccess["asinImages"+section.toUpperCase(section)]();
if(elements.length==0){return;
}elements.each(function(index){var $this=jQuery(this);
var asin=SearchPageAccess.asin($this);
var hoverElement=$this.children("a");
var currentUrls=(sectionUrls&&sectionUrls[asin]);
if(currentUrls&&!hoverElement.children("img").hasClass("placeholder")){SearchImageRotation(hoverElement,currentUrls["mainUrl"],currentUrls["altUrl"],section,asin);
}});
};
var SetupClogImageRotation=function(){this.usageData={};
this.initialize=function(){this.usageData["sawRotationCount"]=0;
this.usageData["atfRotationCount"]=0;
this.usageData["btfRotationCount"]=0;
};
this.LogCount=function(key){this.usageData[key]++;
};
this.initialize();
};
var SearchPageUtilsDef=function(){var $=jQuery;
var self=this;
this.jqEscape=function(myid){return"#"+myid.replace(/:/g,"\\:").replace(/\./g,"\\.");
};
var events={};
this.resetEventsLog=function(){events={};
};
this.triggerATFEvent=function(){if($("#center").is(":visible")){if(!events["spATFEvent"]){self.triggerEvent("spATFEvent");
}}};
this.afterEvent=function(eventType,handler){var origHandler=handler;
handler=function(){try{origHandler.apply(this,arguments);
}catch(e){if(window.ueLogError){window.ueLogError(e);
}}};
if(eventType&&handler&&events[eventType]){handler.call($(document));
}$(document).bind(eventType,handler);
};
this.triggerEvent=function(eventType){if(eventType){events[eventType]=1;
}try{$(document).trigger(eventType);
}catch(e){if(window.ueLogError){window.ueLogError(e);
}}};
this.clearEvent=function(eventType,handler){if(!handler&&eventType){events[eventType]=0;
}$(document).unbind(eventType,handler);
};
};
var promotionsPopoverConfig={showOnHover:true,showCloseButton:false,width:320,location:"bottom",locationAlign:"left",clone:false,hoverShowDelay:150,hoverHideDelay:150};
var processPromotionsPopover=function(){jQuery(".morePromotions").each(function(){var link=jQuery(this);
link.removeAmazonPopoverTrigger();
var popup=link.parent().siblings(".promotions_popup");
if(!popup.get(0).tagName.match(/div/i)){popup=popup.children().get(0);
}else{popup=popup.get(0);
}if(popup){var moreConfigs={localContent:popup};
link.amazonPopoverTrigger(jQuery.extend(true,moreConfigs,promotionsPopoverConfig));
}});
};
function ColorSwatchModel(asin,count,limit){this.asin=asin;
this.count=count;
this.limit=limit;
this.cursor=0;
this.shownFlag=false;
}ColorSwatchModel.prototype={reset:function(){this.cursor=0;
},contentHiddenInLeft:function(){if(this.count<=this.limit){return false;
}if(this.cursor>0){return true;
}return false;
},contentHiddenInRight:function(){if(this.count<=this.limit){return false;
}if(this.cursor<(this.count-this.limit)){return true;
}return false;
},setLimit:function(newLimit){this.limit=newLimit;
},setShownFlag:function(newShownFlag){this.shownFlag=newShownFlag;
}};
amznJQ.available("jQuery",function(){window.ColorSwatchRotationUtil=(function(){var SPRITE_IMAGE_WIDTH=56;
var DOT_IMAGE_WIDTH=24;
var MAX_DOT_IMAGE=7;
var $=jQuery;
function _okToClickColorSwatchArrow(asin,arrow){var model=getColorSwatchModelByAsin(asin);
if(model){if(arrow=="Left"){return model.contentHiddenInLeft();
}else{if(arrow=="Right"){return model.contentHiddenInRight();
}}}}function _manipulateColorSwatchArrow(asin,arrowName,state){var arrowId="#colorSwatchPopunder"+arrowName+"Arrow-"+asin;
var arrowEnabled=arrowName.toLowerCase()+"arrowenabled";
var arrowDisabled=arrowName.toLowerCase()+"arrowdisabled";
var arrow=$(arrowId);
if(arrow&&arrow.length>0){var span=arrow.find("span");
if(state=="enabled"){span.removeClass(arrowDisabled).addClass(arrowEnabled);
}else{if(state="disabled"){span.removeClass(arrowEnabled).addClass(arrowDisabled);
}}}}function _getOppositeArrow(arrowName){if(arrowName=="Left"){return"Right";
}else{if(arrowName=="Right"){return"Left";
}}return;
}function _disableColorSwatchArrow(asin,arrowName){if(!_okToClickColorSwatchArrow(asin,arrowName)){_manipulateColorSwatchArrow(asin,arrowName,"disabled");
}}function _enableColorSwatchArrow(asin,arrowName){if(_okToClickColorSwatchArrow(asin,arrowName)){_manipulateColorSwatchArrow(asin,arrowName,"enabled");
}}function _colorSwatchRotateImage(asin,direction){var model=getColorSwatchModelByAsin(asin);
if(model){var increment=SPRITE_IMAGE_WIDTH;
if(direction=="Right"){model.cursor--;
}else{if(direction=="Left"){model.cursor++;
increment=-SPRITE_IMAGE_WIDTH;
}}var popoverId="#colorSwatchOptionsContainer-"+asin;
var composedImageWrapId=popoverId+" div.composedImage div.composedImageWrap";
var composedImageWrap=$(composedImageWrapId);
if(composedImageWrap){var leftOffset=composedImageWrap.css("left");
var oldLeftOffset=parseInt(leftOffset);
var newLeftOffset=oldLeftOffset+increment;
composedImageWrap.css({"left":newLeftOffset+"px"});
}}}function _hideColorSwatchArrow(model){var asin=model.asin;
var leftArrow=$("#colorSwatchPopunderLeftArrow-"+asin);
var rightArrow=$("#colorSwatchPopunderRightArrow-"+asin);
if(leftArrow&&rightArrow){var leftSpan=leftArrow.find("span");
var rightSpan=rightArrow.find("span");
leftSpan.addClass("leftarrow").removeClass("leftarrowenabled").removeClass("leftarrowdisabled");
rightSpan.addClass("rightarrow").removeClass("rightarrowenabled").removeClass("rightarrowdisabled");
}}function _showColorSwatchArrow(model){if(model.contentHiddenInRight()){var asin=model.asin;
var leftArrow=$("#colorSwatchPopunderLeftArrow-"+asin);
var rightArrow=$("#colorSwatchPopunderRightArrow-"+asin);
if(leftArrow&&rightArrow){var leftSpan=leftArrow.find("span");
var rightSpan=rightArrow.find("span");
leftSpan.removeClass("leftarrow").removeClass("leftarrowenabled").addClass("leftarrowdisabled");
rightSpan.removeClass("rightarrow").addClass("rightarrowenabled");
}}}var _utils={refreshColorSwatchBeard:function(asin,colorSwatchModel){if(!colorSwatchModel.shownFlag){return;
}colorSwatchModel.reset();
var composedImageWrapper=$("#composedImageWrap-"+asin);
composedImageWrapper.css("left","0");
_hideColorSwatchArrow(colorSwatchModel);
_utils.showColorSwatchBeard(asin,colorSwatchModel);
},showColorSwatchBeard:function(asin,colorSwatchModel){var itemResultWidth=$("#colorSwatchContainer-"+asin).parent().parent().width();
var composedImageWrapperNewWidth=colorSwatchModel.count*SPRITE_IMAGE_WIDTH;
var composedImageWidth=colorSwatchOptionsContainerNewWidth=(parseInt((itemResultWidth-20)/SPRITE_IMAGE_WIDTH))*SPRITE_IMAGE_WIDTH;
var needArrow=composedImageWrapperNewWidth>(colorSwatchOptionsContainerNewWidth);
if(needArrow){composedImageWidth=colorSwatchOptionsContainerNewWidth-SPRITE_IMAGE_WIDTH;
}var limit=parseInt(composedImageWidth/SPRITE_IMAGE_WIDTH);
colorSwatchModel.setLimit(limit);
var colorSwatchOptionsContainer=$("#colorSwatchOptionsContainer-"+asin);
$("#composedImage-"+asin).width(composedImageWidth);
$("#composedImageWrap-"+asin).width(composedImageWrapperNewWidth+2);
colorSwatchOptionsContainer.width(colorSwatchOptionsContainerNewWidth);
colorSwatchOptionsContainer.show();
_showColorSwatchArrow(colorSwatchModel);
colorSwatchModel.setShownFlag(true);
},colorSwatchArrowClicked:function(asin,arrowName){if(!_okToClickColorSwatchArrow(asin,arrowName)){return;
}var oppositeArrow=_getOppositeArrow(arrowName);
_colorSwatchRotateImage(asin,oppositeArrow);
_disableColorSwatchArrow(asin,arrowName);
_enableColorSwatchArrow(asin,oppositeArrow);
},swatchImageMouseOver:function(currentSwatchImage,asin,src,isDotImage,detailPageUrl){disableImageRotation(asin);
var colorSwatchContainer;
if(isDotImage){colorSwatchContainer=$("#colorSwatchDotsContainer-"+asin);
}else{colorSwatchContainer=$("#colorSwatchContainer-"+asin);
}if(colorSwatchContainer&&colorSwatchContainer.length>0){var product=colorSwatchContainer.parent().parent();
var productImageDiv=product.find("div.image");
var detailHyperlink=productImageDiv.find("a");
var productImage=productImageDiv.find(".productImage");
if(src&&productImage&&productImage.length>0&&detailPageUrl&&detailHyperlink&&detailHyperlink.length>0){productImage.attr("src",src);
detailHyperlink.attr("href",detailPageUrl);
}if(isDotImage){$(currentSwatchImage).parent().find(".spriteDotImage").each(function(){$(this).removeClass("active").addClass("inactive");
});
$(currentSwatchImage).children(":first").removeClass("inactive").addClass("active");
}else{var currentSpriteImage=$(currentSwatchImage).parent().parent();
currentSpriteImage.parent().find(".spriteImage").each(function(){$(this).removeClass("active").addClass("inactive");
});
currentSpriteImage.removeClass("inactive").addClass("active");
}}},showColorSwatchDotImages:function(asin){var colorSwatchDotsContainer=$("#colorSwatchDotsContainer-"+asin);
if(colorSwatchDotsContainer&&colorSwatchDotsContainer.length>0){var itemResultWidth=colorSwatchDotsContainer.parent().parent().width();
var dotImageCount=parseInt(itemResultWidth/DOT_IMAGE_WIDTH);
dotImageCount=dotImageCount>MAX_DOT_IMAGE?MAX_DOT_IMAGE:dotImageCount;
var compsedDotsImageNewWidth=dotImageCount*DOT_IMAGE_WIDTH;
$("#composedDotsImage-"+asin).width(compsedDotsImageNewWidth);
colorSwatchDotsContainer.show();
}}};
return _utils;
})();
});
function processColorSwatchPopunder(){initColorSwatchRotationDisplay();
}function initColorSwatchRotationDisplay(){var $=jQuery;
var colorSwatchContainers=$("div.colorSwatchContainer");
var colorSwatchDotsContainers=$("div.colorSwatchDotsContainer");
if(colorSwatchContainers&&colorSwatchContainers.length>0){if(window.colorSwatchModels==null){window.colorSwatchModels={};
}colorSwatchContainers.each(function(){var colorSwatchContainer=$(this);
if(colorSwatchContainer&&colorSwatchContainer.length>0){var resultItem=colorSwatchContainer.parent().parent();
var asin=resultItem.attr("name");
var colorSwatchLabel=resultItem.find("div.colorSwatchSeeColorOptions");
var colorSwatchModel=createColorSwatchModel(asin);
var colorSwatchMouseEnterHandler=function(){ColorSwatchRotationUtil.showColorSwatchBeard(asin,colorSwatchModel);
colorSwatchLabel.hide();
};
resultItem.one("mouseenter",colorSwatchMouseEnterHandler);
$(window).bind("resize",function(){ColorSwatchRotationUtil.refreshColorSwatchBeard(asin,colorSwatchModel);
});
}});
}else{if(colorSwatchDotsContainers&&colorSwatchDotsContainers.length>0){colorSwatchDotsContainers.each(function(){var colorSwatchDotsContainer=$(this);
if(colorSwatchDotsContainer&&colorSwatchDotsContainer.length>0){var resultItem=colorSwatchDotsContainer.parent().parent();
var asin=resultItem.attr("name");
ColorSwatchRotationUtil.showColorSwatchDotImages(asin);
$(window).bind("resize",function(){ColorSwatchRotationUtil.showColorSwatchDotImages(asin);
});
}});
}}}function createColorSwatchModel(asin){var $=jQuery;
if(!window.colorSwatchModels[asin]){var colorSwatchComposedImage=$("#composedImage-"+asin);
var count=colorSwatchComposedImage.find("div.spriteImage").length;
var limit=3;
var colorSwatchModel=new ColorSwatchModel(asin,count,limit);
window.colorSwatchModels[asin]=colorSwatchModel;
return colorSwatchModel;
}return window.colorSwatchModels[asin];
}function getColorSwatchModelByAsin(asin){var colorSwatchModels=window.colorSwatchModels;
if(!colorSwatchModels){return;
}return colorSwatchModels[asin];
}function encodeKeywordsForRH(kw){kw=encodeURIComponent(kw).replace(/%2C/g,"\\c");
return kw;
}function buildNormalizedURL(kw,divsl,reftag){var $=jQuery;
var url=$(divsl).attr("data-normalizedURL");
if(kw){url=url.replace("rh=","rh=k%3A"+encodeKeywordsForRH(kw)+"%2C")+"&keyword="+encodeURIComponent(kw);
}url=url.replace(/ref=.*\?/g,"ref="+reftag+"?");
return url.replace(/%20/g,"+");
}var breadcrumbSearch=function(){var $=jQuery,bcsSearchKw=$("#bcsNewKw:text");
if(bcsSearchKw.length<=0){return;
}var bcsCancelEdit=$("#bcsCancelEdit"),bcsGoButton=$("#bcsGoButton"),bcsEditSl="#bcsEdit",msg=$("#bcNewKwReminder").val();
if("bcsNewKw"==$(document.activeElement).attr("id")){bcsSearchKw.css("color","#000000");
bcsCancelEdit.show();
}else{bcsSearchKw.val(msg);
}bcsSearchKw.addClass("bcNewKwNoInput").focus(function(){if(msg==bcsSearchKw.val()){bcsSearchKw.val("").removeClass("bcNewKwNoInput");
}bcsCancelEdit.show();
}).unbind("keypress").keypress(function(event){if(event.which=="13"){submitSearch();
return false;
}});
bcsCancelEdit.unbind("click").click(function(){bcsSearchKw.val(msg).addClass("bcNewKwNoInput");
bcsCancelEdit.hide();
});
bcsGoButton.unbind("click").click(function(){submitSearch();
return false;
});
this.addKeyword=function(kw){document.location=normalizedURLSearch(kw);
};
this.submitSearch=function(){var kw=$.trim(bcsSearchKw.val());
if(kw&&kw!=""&&kw!=msg){addKeyword(kw);
}};
this.normalizedURLSearch=function(kw){return buildNormalizedURL(kw,bcsEditSl,"sr_hi_ebs");
};
};
var editableBreadcrumb=function(){var $=jQuery,bcNewKw=$("#bcNewKw:text");
if(bcNewKw.length<=0){return;
}var bcKw=$(".bcKw"),bcRemoveKwButton=$("#bcRemoveKwButton"),bcKwText=$("#bcKwText"),bcNonEdit=$("#bcNonEdit"),bcCancel=$("#bcCancelEdit"),bcGo=$("#bcGoButton");
bcKwText.unbind("click").click(function(){bcKw.toggle();
bcNewKw.val(getKeywordFromRH());
bcNewKw.focus();
return false;
});
bcRemoveKwButton.hide();
bcNonEdit.unbind("hover").hover(function(){bcNonEdit.removeClass("bcLotPadding").addClass("bcLittlePadding");
bcRemoveKwButton.show();
},function(){bcRemoveKwButton.hide();
if(bcNonEdit.is(":visible")){bcNonEdit.removeClass("bcLittlePadding").addClass("bcLotPadding");
}});
bcRemoveKwButton.unbind("click").click(function(){removeKeyword();
return false;
});
bcCancel.unbind("click").click(function(){bcKw.toggle();
bcNonEdit.removeClass("bcLittlePadding").addClass("bcLotPadding");
return false;
});
bcGo.unbind("click").click(function(){checkEditability();
return false;
});
bcNewKw.unbind("keypress").keypress(function(event){if(event.which=="13"){checkEditability();
return false;
}});
this.editKeyword=function(kw){document.location=normalizedURL(kw);
};
this.removeKeyword=function(){document.location=normalizedURL();
};
var getKeywordsDisplay=function(str){return str.replace(/\+/g," ").replace(/\\c/g,",");
};
var checkEditability=function(){var newKw=$.trim(bcNewKw.val());
if(newKw&&newKw!=""&&getKeywordFromRH()!=newKw){editKeyword(newKw);
}else{if(!newKw||newKw==""){removeKeyword();
}else{bcKw.toggle();
}}};
var getKeywordFromRH=function(){var rh;
if($("#refinements").length>0){rh=$("#refinements").attr("data-baserh");
}else{rh=$("#refinementsOnTop").attr("data-baserh");
}var entries=decodeURIComponent(rh).split(",");
if(entries.length){for(var i=0;
i<entries.length;
i++){var entry=entries[i].split(":");
if(entry.length>=2&&entry.shift()=="k"){return getKeywordsDisplay(entry.join(":"));
}}}};
var encodeKeywords=encodeKeywordsForRH;
this.normalizedURL=function(kw){return buildNormalizedURL(kw,"#bcEdit","sr_hi_eb");
};
};
function showRefinementEl(el){if(null==el){return;
}if(el.css("visibility")=="hidden"){el.css("visibility","visible");
}el.show();
}processFlyout=function(renderOptions){jQuery(renderOptions.hotspotTabDiv).css("visibility","inherit");
var hotspot=jQuery(renderOptions.hotspotDiv);
hotspot.removeAmazonPopoverTrigger();
var width=renderOptions.width;
var options="";
var defaults={showOnHover:true,showCloseButton:false,forceAlignment:true,hoverShowDelay:200,hoverHideDelay:200,localContent:renderOptions.contentDiv,location:"bottom",align:"default",width:width,zIndex:200,skin:"default",locationMargin:4,locationOffset:[hotspot.width()-width+renderOptions.locationOffset,-1],onShow:function(popover){hotspot.bind("closepopover",function(){popover.close();
});
jQuery(renderOptions.hotspotTabDiv).addClass(renderOptions.openStyle);
},onHide:function(popover){hotspot.unbind("closepopover");
jQuery(renderOptions.hotspotTabDiv).removeClass(renderOptions.openStyle);
}};
hotspot.amazonPopoverTrigger(jQuery.extend({},defaults,options));
};
collapsePrimaryRefinements=function(resizeFlag){var $=jQuery,primaryRFWrapper=$("#primaryRefinementsWrapper"),primaryULs=primaryRFWrapper.find(".refinementContent ul"),ulHeight=primaryULs.height(),ulHeightCollapse=20;
if(primaryRFWrapper.length>0&&ulHeight!=ulHeightCollapse){primaryULs.animate({"height":"20px"},"slow");
primaryRFWrapper.find(".blockBorderPreserver").animate({"height":"20px"},"slow");
primaryRFWrapper.animate({"height":"65px"},"slow",function(){primaryRFWrapper.css("overflow","hidden");
});
}};
expandsPrimaryRefinements=function(hotspotID,isPopover){var $=jQuery,primaryRFWrapper=$("#primaryRefinementsWrapper"),primaryULs=primaryRFWrapper.find(".refinementContent ul"),ulHeight=primaryRFWrapper.find("#primaryRefinements .refinementContent ul:visible").height(),ulHeightCollapse=20,targetULs=$("#"+hotspotID).find("ul");
if(ulHeight<=ulHeightCollapse){primaryRFWrapper.animate({"height":"130px"},"slow",function(){primaryRFWrapper.css("overflow","visible");
});
primaryRFWrapper.find(".blockBorderPreserver").animate({"height":"80px"},"slow");
primaryULs.animate({"height":"80px"},"slow",function(){if(isPopover){targetULs.css("overflow","visible");
}});
}};
calculateRFHeight=function(blockID){var $=jQuery,block=$("#"+blockID),lis=block.find("ul:first").children(":visible"),height=0;
for(var i=0;
i<lis.length;
i++){height+=$(lis[i]).height();
}return height;
};
initDownArrow=function(blockID){var $=jQuery,block=$("#"+blockID),ulHeight=("rfGroupBlock"==blockID)?105:85,rfDownArrow=block.find(".rfDownArrowDiv:first"),lisHeight=0,marginLeft=parseInt(block.find("ul li:last").css("margin-left"),10)+5;
lisHeight=calculateRFHeight(blockID);
if(ulHeight<lisHeight){rfDownArrow.css({"margin-left":marginLeft+"px","display":"block"});
return true;
}else{rfDownArrow.hide();
return false;
}};
initPopover=function(hotspotID,shouldExpandPrimaryRF){var $=jQuery,hotspot=$("#"+hotspotID),rfContentBg=hotspot.find(".rfContentBackground"),rfContent=hotspot.find(".refinementContent"),rfDownArrow=hotspot.find(".rfDownArrowDiv"),lisHeight=0,bgStaticHeight=100,bgMiddelHeight=0,hsUls=rfContent.find("ul:first").siblings().andSelf(),issSuggestForm=rfContent.find("#attrSuggestField");
if(rfContent.find(".twoColPicker").length>0){hsUls=rfContent.find("ul:visible");
}hotspot.bind("mouseenter",function(){if(shouldExpandPrimaryRF){expandsPrimaryRefinements(hotspotID,true);
}lisHeight=calculateRFHeight(hotspotID);
bgMiddelHeight=(lisHeight-bgStaticHeight)>0?lisHeight-bgStaticHeight:0;
rfDownArrow.hide();
rfContent.addClass("refinementShoveler");
rfContentBg.children(".bgMiddle").css("height",bgMiddelHeight+"px");
rfContentBg.show();
hsUls.css("overflow","visible");
});
hotspot.bind("mouseleave",function(){var timeout=null,lagTime=0;
if(issSuggestForm.length>0){issSuggestForm.blur();
lagTime=500;
}timeout=setTimeout(function(){if(initLuxuryRefinementsPopover.preventUnnecessaryMouseleave){initLuxuryRefinementsPopover.preventUnnecessaryMouseleave=false;
return;
}hsUls.css("overflow","hidden");
rfContentBg.hide();
rfContent.removeClass("refinementShoveler");
rfDownArrow.show();
},lagTime);
});
};
initGroupPopover=function(){var $=jQuery,rfGroupPopContainer=$("#rfGroupPopContainer"),rfContentBg=rfGroupPopContainer.find(".rfContentBackground"),rfContentBg2=rfGroupPopContainer.find(".rfContentBackground2"),primaryRFWrapper=$("#primaryRefinementsWrapper"),rfGroupConentWrapper=primaryRFWrapper.find("#rfGroupContentWrapper"),rfGroupContentContainer=rfGroupConentWrapper.find("#rfGroupContentContainer"),popRF=rfGroupPopContainer.find("#popRefinement"),popRFGroup=rfGroupPopContainer.find("#popRFGroupContent");
primaryRFBlockId="#pri_rfBlock",mouseoverRFLabel=function(){var rfLabel=$(this).parent(),previousRefinement=popRF.children(),currIndex=parseInt(rfLabel.attr("data-index")),popBgStaticHeight=120,popRefinementHeight=popGroupHeight=popOverHeight=0,bgHeight=bgMiddelHeight=blankHeight=topHeight=midHeight=bottomHeight=0;
initLuxuryRefinementsPopover.preventUnnecessaryMouseleave=true;
if(previousRefinement.length>0){if(currIndex==parseInt(previousRefinement.attr("data-index"))){return true;
}previousRefinement.insertBefore($(primaryRFBlockId+previousRefinement.attr("data-index")).find(".rfDownArrowDiv"));
previousRefinement.find("ul").css("overflow","hidden");
}primaryRFWrapper.find(primaryRFBlockId+currIndex+" .refinementContent").appendTo(popRF);
primaryRFWrapper.find("#rfGroupBlockContent").appendTo(popRFGroup).removeClass("refinementShoveler");
rfGroupPopContainer.show();
popRF.find("ul:first").siblings().andSelf().css("overflow","visible");
var popGroupLabels=popRFGroup.find("ul li:visible");
popGroupLabels.each(function(){$(this).removeClass("rfLabelSelected");
});
rfLabel.addClass("rfLabelSelected");
var lis=popRF.find("ul:first").children(":visible");
for(var i=0;
i<lis.length;
i++){popRefinementHeight+=$(lis[i]).height();
}for(var i=0;
i<popGroupLabels.size();
i++){popGroupHeight+=$(popGroupLabels[i]).height();
}popOverHeight=popRefinementHeight>=popGroupHeight?popRefinementHeight:popGroupHeight;
bgMiddelHeight=popOverHeight-popBgStaticHeight;
bgMiddelHeight=bgMiddelHeight>0?bgMiddelHeight:0;
rfContentBg.children(".bgPopMiddle").css({"height":bgMiddelHeight+"px","line-height":bgMiddelHeight+"px","font-size":bgMiddelHeight+"px"});
bgHeight=160+bgMiddelHeight;
popGroupLabels.each(function(){var index=parseInt($(this).attr("data-index"));
if(index==currIndex){midHeight+=$(this).height();
}else{if(index<currIndex){topHeight+=$(this).height();
}else{bottomHeight+=$(this).height();
}}});
blankHeight=bgHeight-topHeight-midHeight-bottomHeight;
rfContentBg2.children(".bgPopLinedown").css({"display":"none"});
rfContentBg2.children(".bgPopLineup").css({"height":topHeight+"px","line-height":topHeight+"px","background-position":"0 "+(topHeight-300)+"px"});
rfContentBg2.children(".bgPopLineMiddle").css("height",midHeight+"px");
if(bottomHeight>0){rfContentBg2.children(".bgPopLinedown").css({"display":"block","height":(blankHeight+bottomHeight)+"px"});
}rfGroupPopContainer.show();
rfContentBg.show();
rfContentBg2.show();
rfGroupConentWrapper.find(".rfContentBackground").hide();
rfGroupConentWrapper.hide();
return false;
};
rfGroupPopContainer.bind("mouseleave",function(){initLuxuryRefinementsPopover.preventUnnecessaryMouseleave=false;
var previousRefinement=popRF.children();
if(previousRefinement.length>0){previousRefinement.insertBefore($(primaryRFBlockId+previousRefinement.attr("data-index")).find(".rfDownArrowDiv"));
previousRefinement.find("ul:first").siblings().andSelf().css("overflow","hidden");
}var rfGroup=popRFGroup.children();
if(rfGroup.length>0){rfGroup.appendTo(rfGroupContentContainer);
}rfGroupPopContainer.hide();
rfGroupConentWrapper.find("ul").css("overflow","hidden");
rfGroupConentWrapper.show();
initDownArrow("rfGroupBlock");
});
rfGroupConentWrapper.find("ul li").each(function(){if(!$(this).hasClass("rfSelectedValue")){$(this).children().mouseover(mouseoverRFLabel);
}});
};
initGroupBlock=function(){var $=jQuery,primaryRFWrapper=$("#primaryRefinementsWrapper"),rfGroupBlock=primaryRFWrapper.find("#rfGroupBlock"),priRFWidth=primaryRFWrapper.width(),rfBlocks=primaryRFWrapper.find("#primaryRefinements .refinementBlock"),rfBlockNum=rfBlocks.size(),blockWidth=$(rfBlocks[0]).width(),displayNum=availableBlockNum=0;
if(blockWidth<=0){return;
}displayNum=Math.floor(priRFWidth/blockWidth);
availableBlockNum=displayNum-1;
if(displayNum>=rfBlockNum){rfGroupBlock.hide();
availableBlockNum++;
}for(var i=1;
i<=rfBlocks.length;
i++){if(i<=availableBlockNum){$(rfBlocks[i-1]).show();
$("#rfGroupBlock ul li[@data-index="+i+"]").each(function(){$(this).hide();
});
if(i==availableBlockNum){if($("#selectedRefinementInsertion")[0]){$("#selectedRefinementInsertion").remove();
}var selectedRefinementInsertion=$("<li id='selectedRefinementInsertion'></li>");
selectedRefinementInsertion.hide();
$("#rfGroupBlock ul li[@data-index="+i+"]").after(selectedRefinementInsertion);
}}else{$(rfBlocks[i-1]).hide();
$("#rfGroupBlock ul li[@data-index="+i+"]").each(function(){$(this).show();
});
}}if(displayNum<rfBlockNum){rfGroupBlock.find("#rfGroupContentWrapper").show();
rfGroupBlock.show();
}};
processRefinementBlock=function(hotspotID,hasDependentRF,filterNoPopover){var $=jQuery,hotspot=$("#"+hotspotID);
hotspot.unbind("mouseenter");
hotspot.unbind("mouseleave");
if(filterNoPopover[hotspotID]==false){if(hasDependentRF){hotspot.bind("mouseenter",function(){expandsPrimaryRefinements(hotspotID,false);
});
}return;
}if(initDownArrow(hotspotID)){initPopover(hotspotID,hasDependentRF);
}else{if(hasDependentRF){hotspot.bind("mouseenter",function(){expandsPrimaryRefinements(hotspotID,false);
});
}}};
initLuxuryRefinementsPopover=function(){var $=jQuery,filterNoPopover={},luxuryRF=$("#luxuryRefinements"),primaryRFWrapper=luxuryRF.find("#primaryRefinementsWrapper"),dependentRF=luxuryRF.find("#dependentRefinements"),priRFBlocks=primaryRFWrapper.find(".refinementBlock"),rfGroupContent=primaryRFWrapper.find("#rfGroupContentWrapper");
hasDependentRF=dependentRF.length>0;
initLuxuryRefinementsPopover.preventUnnecessaryMouseleave=false;
initGroupBlock();
primaryRFWrapper.css("overflow","visible");
if(hasDependentRF){priRFBlocks.each(function(){var self=$(this),hotspotID=self.attr("id");
if(!initDownArrow(hotspotID)){filterNoPopover[hotspotID]=false;
}});
collapsePrimaryRefinements();
popoverTimeout=setTimeout(function(){priRFBlocks.each(function(){processRefinementBlock($(this).attr("id"),hasDependentRF,filterNoPopover);
});
},1000);
}else{filterNoPopover={};
priRFBlocks.each(function(){processRefinementBlock($(this).attr("id"),hasDependentRF,filterNoPopover);
});
}initGroupPopover();
dependentRF.find(".refinementBlock").each(function(){var self=$(this),hotspotID=self.attr("id");
if(initDownArrow(hotspotID)){initPopover(hotspotID,false);
}});
$(window).resize(function(){var timeout=null;
if(timeout){clearTimeout(timeout);
}timeout=setTimeout(function(){initGroupBlock();
filterNoPopover={};
priRFBlocks.each(function(){processRefinementBlock($(this).attr("id"),hasDependentRF,filterNoPopover);
});
reorderLuxuryRefinementGroupBlock();
},500);
});
reorderLuxuryRefinementGroupBlock();
};
processLuxuryRefinementsPopover=function(){initLuxuryRefinementsPopover();
};
processRefinementsOnTopMore=function(){var $=jQuery;
amznJQ.onReady("jQuery",function(){var extraRfs=$("#extraRefinementsOnTop");
var extraRfsDisplay=extraRfs.css("display");
if(extraRfsDisplay=="none"){$("#extraRefinementsOnTop").show();
}$("#refinementsOnTop div").each(function(){if($(this).hasClass("refinementLine")&&$(this).height()<35){var ul=$(this).find("ul:eq(0)");
if(ul.height()>35){var ulTarget=ul.find("li:last");
if(ulTarget.css("visibility")=="hidden"||ulTarget.css("display")=="none"){showRefinementEl(ul.find("li:eq(0)"));
}}}});
if(extraRfsDisplay=="none"){$("#extraRefinementsOnTop").hide();
}});
};
var seeMoreRefinementsOnTop=function(){jQuery("#extraRefinementsOnTop").show();
jQuery("#seeMoreRefinementsOnTop").hide();
jQuery("#seeLessRefinementsOnTop").show();
};
var seeLessRefinementsOnTop=function(){jQuery("#extraRefinementsOnTop").hide();
jQuery("#seeMoreRefinementsOnTop").show();
jQuery("#seeLessRefinementsOnTop").hide();
};
var expandRefinement=function(current){var $=jQuery;
var current=$(current);
current.parents(".refinementLine").height("auto");
showRefinementEl(current.parent().find("li:hidden"));
current.hide();
};
var collapseRefinement=function(current){var $=jQuery;
var current=$(current);
current.parents(".refinementLine").height("28px");
showRefinementEl(current.parent().find("li:hidden"));
current.hide();
};
var submitSortForm=function(current){var $=jQuery;
var current=$(current);
var form=$("#searchSortForm");
var input=form.find("input:eq(0)");
input.val(current.parent()[0].getAttribute("value"));
form.submit();
};
function toggleVisualPickers(containerId,linkElement){jQuery("#"+containerId).find(".vpHidden").toggle();
jQuery(linkElement).find(".vpSeeOptionText").toggle();
}reorderLuxuryRefinementGroupBlock=function(){var $=jQuery;
var visibleSelectedRefinements=$('li[luxuryRefinementToMoveToTop="true"]:visible');
var insertionPoint=$("#selectedRefinementInsertion");
for(var i=0;
i<visibleSelectedRefinements.size();
i++){insertionPoint.before($(visibleSelectedRefinements.get(i)));
}};
function registerAivHandler(resultsContainerSelector){var $=jQuery;
var addRemoveBaseUrl="/gp/video/watchlist/ajax/addRemove.html";
var signInUrlTemplate="/gp/sign-in.html";
var signInData={pageAction:"/gp/video/watchlist",path:"/gp/video/watchlist",redirectProtocol:"http",useRedirectOnSuccess:"1"};
var watchListQueryParams={toggleOnWatchlist:"1",returnToDp:"1"};
var hideUnhide=function(toHide,toUnhide){toHide.addClass("hidden");
toUnhide.removeClass("hidden");
};
var watchlistAjaxCaller=function(startElement,transitionElement,endElement,actionData,refTag,addItem){startElement.addClass("hidden");
transitionElement.removeClass("hidden");
actionData.token=$.pageContext.csrfToken;
actionData.ref=refTag;
actionData.addItem=addItem;
$.ajax({url:addRemoveBaseUrl,data:actionData,success:function(jsonResponse){var response=typeof(jsonResponse)=="string"?JSON.parse(jsonResponse):jsonResponse;
if(response&&response.AsinStatus&&response.AsinStatus==addItem){hideUnhide(transitionElement,endElement);
}else{hideUnhide(transitionElement,startElement);
}},failure:function(jsonResponse){hideUnhide(transitionElement,startElement);
}});
};
var removeFromWatchlist=function(eventData){watchlistAjaxCaller(eventData.data.removeFromWatchlistElement,eventData.data.removingElement,eventData.data.addToWatchlistElement,eventData.data.urlData,"sr_1_"+eventData.data.asinIndex+"_watchlist_remove",0);
};
var addToWatchlist=function(eventData){watchlistAjaxCaller(eventData.data.addToWatchlistElement,eventData.data.addingElement,eventData.data.removeFromWatchlistElement,eventData.data.urlData,"sr_1_"+eventData.data.asinIndex+"_watchlist_add",1);
};
var attachAivHandlersToProductItem=function(product){var addToWatchlistElement=$(product).find(".addToWatchlist");
if(addToWatchlistElement.length!==0){var removeFromWatchlistElement=$(product).find(".inWatchlistAndRemove");
var addingElement=$(product).find(".adding");
var removingElement=$(product).find(".removing");
var asin=$(product).find(".watchlist").attr("asin");
if(asin==null){asin=$(product).find(".watchlistWithAddtocart").attr("asin");
}if(asin==null){asin=$(product).find(".watchlist2").attr("asin");
}var asinDisplayIndex=SearchPageAccess.asinDisplayIndex(product)+1;
var handlerData={urlData:{dataType:"json",prodType:"movie",ASIN:asin},removeFromWatchlistElement:removeFromWatchlistElement,addToWatchlistElement:addToWatchlistElement,removingElement:removingElement,addingElement:addingElement,asinIndex:asinDisplayIndex};
addToWatchlistElement.unbind("click").bind("click",handlerData,addToWatchlist);
removeFromWatchlistElement.find(".remove").unbind("click").bind("click",handlerData,removeFromWatchlist);
}};
SearchPageAccess.asinResults(resultsContainerSelector).each(function(index,product){attachAivHandlersToProductItem(product);
});
}function validatePostalCode(zipForm){var $=jQuery;
var zip=zipForm.p_postal_code;
var valid=zip.value.match(/\d{5}/)!=null;
var errEl=$("#error_msg");
if(!valid){errEl[0].style.display="inline";
}else{errEl[0].style.display="none";
}return valid;
}function setInputPrompt(elem,prompt){if(elem.value==""){elem.value=prompt;
}if(elem.value==prompt){elem.style.color="#CCC";
}else{elem.style.color="#000";
}elem.onblur=function(){if(elem.value==""){elem.value=prompt;
elem.style.color="#CCC";
}};
elem.onfocus=function(){jQuery("#error_msg")[0].style.display="none";
if(elem.value==prompt){elem.value="";
elem.style.color="#000";
}};
}function setFinancialValidation(){var $=jQuery;
$(document).ready(function(){var pc=$("#p_postal_code");
var zcp=$("#zip_code_prompt");
if(pc.length>0&&zcp.length>0){setInputPrompt(pc[0],zcp[0].innerHTML);
}});
}function shipToStateRedirect(){if(jQuery("#p_discriminators :selected").length!=0&&jQuery("#p_discriminators :selected").val()!=""){location.href=jQuery("#p_discriminators :selected").val();
}}function processPredictedRatingPopover(){var predictedRatingPopoverConfig={showOnHover:true,showCloseButton:false,width:288,location:"bottom",locationAlign:"left",locationOffset:[-20,0],group:"reviewsPopover",clone:false,hoverHideDelay:300,title:"&nbsp;"};
jQuery(".predictedRatingSummary, .predictedRatingText").each(function(){jQuery(this).removeAmazonPopoverTrigger();
var asin=jQuery(this).attr("name");
var ref=jQuery(this).attr("ref");
var remoteContentAddr="/gp/product/features/predicted-product-rating-ajax.html?"+"ASIN="+asin+"&ref="+ref;
var myConfig=jQuery.extend(true,{},predictedRatingPopoverConfig);
myConfig.destination=remoteContentAddr;
jQuery(this).amazonPopoverTrigger(myConfig);
});
}amznJQ.available("jQuery",function(){window.SearchPageAccess=new SearchPageAccessDef();
window.SPUtils=new SearchPageUtilsDef();
window.ClogImageRotation=new SetupClogImageRotation();
jQuery(document).bind("ph",function(){if(typeof window.srImageUrls!="undefined"&&typeof window.ClogImageRotation!="undefined"&&window.foresterVip){var protocol=location.protocol=="https:"?"https://":"http://",url=protocol+foresterVip+"/1/softlines/1/OP/imagerotation?"+jQuery.param(ClogImageRotation.usageData);
(new Image()).src=url;
ClogImageRotation.initialize();
}});
amznJQ.declareAvailable("search-js-general");
amznJQ.declareAvailable("ImageRotation");
});
